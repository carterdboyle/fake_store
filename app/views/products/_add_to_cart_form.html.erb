<%= turbo_frame_tag "add_to_cart_form", dom_id(product, :add) do %>
  <%= form_with url: cart_items_path, method: :post do |f| %>
    <div class="flex justify-around mb-2">
      <%= hidden_field_tag :product_id, product.id %>

      <%= number_field_tag :quantity, 1,
            min: 1,
            max: [99, product.amount.to_i].min,     # clamp to available stock (cap at 99)
            class: "qty-input w-20 rounded border px-2 py-1 text-center disabled:opacity-50 disabled:cursor-not-allowed",
            disabled: !product.in_stock %>

      <%= f.submit "Add to cart",
            class: "ml-2 rounded bg-yellow-300 transition duration-300 enabled:hover:-translate-y-1 enabled:hover:scale-110 enabled:hover:cursor-pointer hover:bg-yellow-200 px-3 py-1 disabled:opacity-50 disabled:cursor-not-allowed",
            disabled: !product.in_stock %>
    </div>
  <% end %>
<% end %>